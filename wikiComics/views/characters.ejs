<%- include('partials/header') %>

<main class="container py-4" style="padding: bottom 50rem;">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h3 style="font-size: 2rem; color: rgb(255, 255, 255); font-family: 'Bangers', cursive;">Manage Characters</h3>
    <a href="/" class="btn btn-dark">Back to Home</a>
  </div>

  <% if (!characters || characters.length === 0) { %>
    <div class="alert alert-info">No characters found.</div>
  <% } else { %>
    <div class="table-responsive">
      <table class="table table-striped align-middle">
        <thead>
          <tr>
            <th scope="col">Image</th>
            <th scope="col">Name</th>
            <th scope="col">Short Description</th>
            <th scope="col">Actions</th>
          </tr>
        </thead>
        <tbody>
          <% characters.forEach(function(character) { %>
            <tr>
              <td style="width:120px;">
                <% if (character.image && character.image.data) { %>
                  <img src="/characters/image/<%= character._id %>" alt="<%= character.name %>" class="img-fluid rounded" style="max-height:80px;">
                <% } else if (character.imageUrl) { %>
                  <img src="<%= character.imageUrl %>" alt="<%= character.name %>" class="img-fluid rounded" style="max-height:80px;">
                <% } else { %>
                  <div class="text-muted">No image</div>
                <% } %>
              </td>
              <td><strong><%= character.name %></strong></td>
              <td><%= character.shortDescription || 'â€”' %></td>
              <td>
                <a href="/characters/<%= character._id %>" class="btn btn-sm btn-primary me-2">More</a>
                <form method="POST" action="/characters/<%= character._id %>/delete" style="display:inline-block;" onsubmit="return confirm('Are you sure you want to delete this character?');">
                  <button type="submit" class="btn btn-sm btn-danger">Delete</button>
                </form>
              </td>
            </tr>
          <% }); %>
        </tbody>
      </table>
    </div>
  <% } %>
</main>

<%- include('partials/footer') %>